# Сервис Anti-Fraud

Сервис для **проверки клиентов на мошенничество** с кэшированием в Redis и мониторингом через Prometheus+Grafana.

## Используемые технологии

Проект использует следующий стек технологий:

*   **Python**
*   **FastAPI**
*   **Pydantic**
*   **Redis**
*   **Pytest**
*   **Prometheus**
*   **Grafana**
*   **Docker / Docker Compose**

## Логика работы сервиса

Сервис принимает запрос с данными клиента: дата рождения, номер телефона, история займов.

### Алгоритм проверки:

1.  **Кэширование**: Перед выполнением проверок сервис проверяет наличие результата в Redis. Если результат найден в кэше — он сразу возвращается.
2.  **Выполнение проверок**: Если результата нет, выполняются проверки на стоп-факторы:
    *   Номер телефона начинается не с `+7` или `8`.
    *   Клиенту меньше 18 лет.
    *   У клиента есть хотя бы один не закрытый займ.
3.  **Результат**: Итоговый список стоп-факторов и флаг (`true` или `false`) сохраняется в Redis и возвращается клиенту.

## Запуск проекта

### Требования

*   Установленный **Docker**
*   Установленный **Docker Compose**

### Запуск

Из корня проекта выполните команду:

docker compose up --build

## Тестирование
Запуск тестов
uv run pytest tests/test_antifraud.py

### Доступные адреса

Используйте следующие ссылки для доступа к интерфейсам сервисов:

*   **Swagger UI**: http://localhost:8000/docs
*   **Метрики сервиса**: http://localhost:8000/metrics
*   **Prometheus**: http://localhost:9090
*   **Grafana**: http://localhost:3000

#### Данные для входа в Grafana

| Параметр | Значение |
| :--- | :--- |
| Логин | `admin` |
| Пароль | `admin` |
